<div mat-dialog-title>布局设置</div>
<mat-divider></mat-divider>
<mat-dialog-content class="h-0 flex-1 max-h-none!">
  <form
    [formGroup]="form"
    appearance="outline"
    class="hs-density--5 flex flex-col gap-12px mb-12px!"
  >
    <!-- gridType -->
    <mat-label>网格类型</mat-label>
    <mat-form-field appearance="outline">
      <mat-select formControlName="gridType">
        @for (t of gridTypes; track t) {
          <mat-option [value]="t">{{ t }}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <!-- margin -->
    <mat-label>间距(px)</mat-label>
    <mat-form-field appearance="outline">
      <input matInput type="number" formControlName="margin" />
    </mat-form-field>

    <!-- displayGrid -->
    <mat-label>网格线显示</mat-label>
    <mat-form-field appearance="outline">
      <mat-select formControlName="displayGrid">
        @for (d of displayGrid; track d) {
          <mat-option [value]="d">{{ d }}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <mat-label>允许覆盖已有格子</mat-label>
    <mat-slide-toggle formControlName="enableOccupiedCellDrop" labelPosition="before">
    </mat-slide-toggle>

    <mat-label>最小行数</mat-label>
    <mat-form-field appearance="outline">
      <input matInput type="number" formControlName="minRows" />
    </mat-form-field>

    <mat-label>最小列数</mat-label>
    <mat-form-field appearance="outline">
      <input matInput type="number" formControlName="minCols" />
    </mat-form-field>

    <mat-label>背景颜色</mat-label>
    <mat-form-field appearance="outline">
      <!-- <div> -->
      <!-- @let backgroundColor = form.get('backgroundColor')?.value || 'transparent'; -->
      <input
        matInput
        color-picker
        formControlName="backgroundColor"
        [style.background]="form.value.backgroundColor"
        [cpOutputFormat]="'rgba'"
        [(colorPicker)]="form.value.backgroundColor"
        [cpEyeDropper]="true"
        [cpSaveClickOutside]="false"
        [cpPresetColors]="['#fff', '#2889e9']"
        [cpOKButton]="true"
        [cpCancelButton]="true"
        [cpCancelButtonText]="'取消'"
        [cpOKButtonText]="'确定'"
        cpCancelButtonClass="cursor-pointer"
        cpOKButtonClass="cursor-pointer"
        class="225px"
        (colorPickerChange)="form.patchValue({ backgroundColor: $event })"
      />
      <!-- </div>  -->
    </mat-form-field>

    <div class="my-8px">
      <mat-label class="block mb-12px">背景图片：</mat-label>
      <hs-file-upload
        [fold]="true"
        fileShowType="grid"
        [multiple]="false"
        [(fileList)]="fileList"
        [uploadUrl]="'/api/files/upload?bucket=' + bucket + '&path=' + folderName"
        (delItemFile)="delItemFile($event)"
        class="flex-1"
        [maxCount]="1"
        [cols]="1"
        class="flex-1 w-120px h-120px block"
      ></hs-file-upload>
    </div>

    <mat-label>背景模式大小</mat-label>
    <mat-form-field appearance="outline">
      <mat-select formControlName="backgroundSize">
        @for (t of backgroundModeTypes; track t) {
          <mat-option [value]="t.value">{{ t.label }}</mat-option>
        }
      </mat-select>
    </mat-form-field>
  </form>
</mat-dialog-content>
<mat-divider></mat-divider>
<mat-dialog-actions align="end">
  <button mat-button mat-dialog-close (click)="cancel()">取消</button>
  <button mat-flat-button (click)="saveConfig()">确定</button>
</mat-dialog-actions>
